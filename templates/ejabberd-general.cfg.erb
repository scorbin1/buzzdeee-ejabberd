###
###              ejabberd configuration file
###
### The parameters used in this configuration file are explained at
###
###       https://docs.ejabberd.im/admin/configuration
###
### The configuration file is written in YAML.
### *******************************************************
### *******           !!! WARNING !!!               *******
### *******     YAML IS INDENTATION SENSITIVE       *******
### ******* MAKE SURE YOU INDENT SECTIONS CORRECTLY *******
### *******************************************************
### Refer to http://en.wikipedia.org/wiki/YAML for the brief description.
###


# loglevel: Verbosity of log files generated by ejabberd
loglevel: <%= @log_level %>

# rotation: Disable ejabberd's internal log rotation, as the Debian package
# uses logrotate(8).
log_rotate_count: <%= @log_rotate_count %>

# hosts: Domains served by ejabberd.
# You can define one or several, for example:
# hosts:
#   - "example.net"
#   - "example.com"
#   - "example.org"

<% if @domains.is_a? Array -%>
hosts:
<%- @domains.each do |domain| -%>
  - <%= domain %>
<%- end -%>
<%- else -%>
hosts:
  "- <%= @domains %>"
<% end -%>

certfiles:
  - "<%= @servercertfile %>"
<%- if @servercertfile == '/etc/ejabberd/ejabberd.pem' -%>
#  - /etc/letsencrypt/live/localhost/fullchain.pem
#  - /etc/letsencrypt/live/localhost/privkey.pem
<% end %>
# TLS configuration
define_macro:
  'TLS_CIPHERS': "HIGH:!aNULL:!eNULL:!3DES:@STRENGTH"
  'TLS_OPTIONS':
<% if @tls_options.is_a? Array -%>
<%- @tls_options.each do |option| -%>
    - "<%= option %>"
<%- end -%>
<%- else -%>
    - "<%= tls_options %>"
<% end -%>
    # 'DH_FILE': "/path/to/dhparams.pem"
    # generated with: openssl dhparam -out dhparams.pem 2048

c2s_ciphers: 'TLS_CIPHERS'
<%- if @disable_s2s == false -%>s2s_ciphers: 'TLS_CIPHERS'
<%- end -%>
c2s_protocol_options: 'TLS_OPTIONS'
<%- if @disable_s2s == false -%>s2s_protocol_options: 'TLS_OPTIONS'
<%- end -%>
# c2s_dhfile: 'DH_FILE'
<%- if @disable_s2s == false -%># s2s_dhfile: 'DH_FILE'
<%- end -%>

<%- if @language != 'en' and @language != '' -%>language: <%= @language %><%- end -%>